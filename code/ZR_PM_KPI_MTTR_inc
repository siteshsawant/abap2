*&---------------------------------------------------------------------*
*&  Include           ZKPIMTTR
*&---------------------------------------------------------------------*

  DATA: G_REPID TYPE SY-REPID.
  G_REPID = SY-REPID.
  TABLES: VIQMEL.
  SELECTION-SCREEN BEGIN OF BLOCK SEL WITH FRAME.

  SELECT-OPTIONS: S_EQUNR FOR VIQMEL-EQUNR,
                  S_TPLNR FOR VIQMEL-TPLNR.
*                  P_PLANT FOR VIQMEL-SWERK.
  PARAMETERS: P_PLANT TYPE VIQMEL-SWERK OBLIGATORY.

*  SELECTION-SCREEN BEGIN OF LINE.
*    PARAMETERS : SMONTH TYPE CHAR20,
*                 SYEAR  TYPE CHAR4.
*  SELECTION-SCREEN END OF LINE.
  SELECTION-SCREEN BEGIN OF LINE.
  SELECTION-SCREEN COMMENT (5) T8.
  SELECTION-SCREEN END OF LINE.
  SELECTION-SCREEN BEGIN OF LINE.
  SELECTION-SCREEN COMMENT (15) T2.
  PARAMETERS : P_MONTH(2) TYPE N AS LISTBOX VISIBLE LENGTH 10 OBLIGATORY.
  SELECTION-SCREEN COMMENT (1) T6.
  PARAMETERS : P_YEAR(4)  TYPE N AS LISTBOX VISIBLE LENGTH 10 OBLIGATORY.
  SELECTION-SCREEN END OF LINE.
  SELECTION-SCREEN BEGIN OF LINE.
  SELECTION-SCREEN COMMENT (15) T3.
  PARAMETERS: P_WEEK(2) TYPE N AS LISTBOX VISIBLE LENGTH 10.
*  SELECTION-SCREEN COMMENT (1) T7.
**PARAMETERS: P_SUN AS CHECKBOX USER-COMMAND SUN.
**SELECTION-SCREEN COMMENT (15) T4.
*  SELECTION-SCREEN END OF LINE.
**SELECTION-SCREEN BEGIN OF LINE.
**SELECTION-SCREEN COMMENT (15) T5.
**PARAMETERS: P_HOURS(2) TYPE N AS LISTBOX VISIBLE LENGTH 10.
  SELECTION-SCREEN END OF LINE.
  SELECTION-SCREEN END OF BLOCK SEL.

  TYPES: BEGIN OF LINETYPE,
           SIGN   TYPE C LENGTH 1,
           OPTION TYPE C LENGTH 2,
           LOW    TYPE SY-DATUM,
           HIGH   TYPE SY-DATUM,
           WEEK   TYPE C,
           WCOUNT TYPE C,
         END OF LINETYPE.


  DATA: LT_WEEK    TYPE TABLE OF LINETYPE WITH HEADER LINE.



  DATA: DD(2)     TYPE C,LOOPS(2)   TYPE C, MM(2) TYPE C, YEAR(4) TYPE C, TEMP_WEEK LIKE SCAL-WEEK, WEEK1 LIKE SCAL-WEEK, WEEK2 LIKE SCAL-WEEK, DATE1 TYPE SY-DATUM, DATE2 TYPE SY-DATUM.
  DATA: SWEEK(2) TYPE C, EWEEK(2) TYPE C.
  DATA : W_DATE  TYPE D, W_LDATE TYPE D.
  DATA: WEEKNO TYPE CHAR1,
        WOP    TYPE INT4.

  TYPES: BEGIN OF TY_FINAL,
           WEEK          TYPE STRING,
           WEEK2         TYPE STRING,
           SWERK         TYPE VIQMEL-SWERK,
           TPLNR         TYPE VIQMEL-TPLNR,
           PLTXT         TYPE IFLOTX-PLTXT,
           EQUNR         TYPE VIAUFKS-EQUNR,
           EQKTX         TYPE EQKT-EQKTX,
           NOTIF_COUNT   TYPE P DECIMALS 2,
           BREAK_TIME    TYPE P DECIMALS 2,
           MTTR          TYPE P DECIMALS 2,
           LINE_COLOR(4) TYPE C,
         END OF TY_FINAL.

  TYPES: BEGIN OF TY_FINAL2,
           WEEKNO     TYPE STRING,
           SWERK      TYPE VIQMEL-SWERK,
           TPLNR      TYPE VIQMEL-TPLNR,
           PLTXT      TYPE IFLOTX-PLTXT,
           EQUNR      TYPE VIAUFKS-EQUNR,
           EQKTX      TYPE EQKT-EQKTX,
           QMNUM      TYPE VIQMEL-QMNUM,
           QMTXT      TYPE VIQMEL-QMTXT,
           BREAK_TIME TYPE P DECIMALS 2,
           AUSVN      TYPE VIQMEL-AUSVN,
           AUSBS      TYPE VIQMEL-AUSBS,
           AUZTV      TYPE VIQMEL-AUZTV,
           AUZTB      TYPE VIQMEL-AUZTB,
         END OF TY_FINAL2.


  DATA: LT_FINAL TYPE TABLE OF TY_FINAL WITH HEADER LINE.

  DATA: WA_FCAT      TYPE SLIS_FIELDCAT_ALV,
        IT_FCAT      TYPE SLIS_T_FIELDCAT_ALV,
        WA_FCAT2     TYPE SLIS_FIELDCAT_ALV,
        IT_FCAT2     TYPE SLIS_T_FIELDCAT_ALV,
        WA_SEL       TYPE SLIS_SELFIELD,
        "ALV layout work area
        WA_LAYOUT    TYPE SLIS_LAYOUT_ALV,

        "Key information for hierarchical list
        WA_KEY       TYPE SLIS_KEYINFO_ALV,
        GD_TAB_GROUP TYPE SLIS_T_SP_GROUP_ALV,
        GD_LAYOUT    TYPE SLIS_LAYOUT_ALV,
        GD_LAYOUT2   TYPE SLIS_LAYOUT_ALV,
        IT_SORT      TYPE SLIS_T_SORTINFO_ALV WITH HEADER LINE,
        WA_SORT      TYPE SLIS_T_SORTINFO_ALV,
        IT_SORT2     TYPE SLIS_T_SORTINFO_ALV WITH HEADER LINE,
        WA_SORT2     TYPE SLIS_T_SORTINFO_ALV,
        LT_SUBLIST   TYPE TABLE OF TY_FINAL2,
        WA_SUBLIST   TYPE TY_FINAL2,
        LT_NOTS      TYPE TABLE OF TY_FINAL2,
        WA_NOTS      TYPE TY_FINAL2.

*  DATA: IT_LISTHEADER TYPE SLIS_T_LISTHEADER,
*        WA_LISTHEADER TYPE SLIS_LISTHEADER.
